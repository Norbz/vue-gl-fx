!function(n){var i={};function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=n,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/vue-gl-fx/",o(o.s=11)}({11:function(t,e,n){t.exports=n(12)},12:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function a(i,t,e){function n(t,e){var n=i.createShader(t);if(i.shaderSource(n,e),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw console.error("An error occurred compiling the shaders: ".concat(i.getShaderInfoLog(n))),i.deleteShader(n),new Error(i.getShaderInfoLog(n));return n}var o=n(i.VERTEX_SHADER,t),r=n(i.FRAGMENT_SHADER,e),a=i.createProgram();if(i.attachShader(a,o),i.attachShader(a,r),i.linkProgram(a),i.useProgram(a),!i.getProgramParameter(a,i.LINK_STATUS))throw console.error("Error when initialising the program : ".concat(i.getProgramInfoLog(a))),new Error(i.getProgramInfoLog(a));return i.deleteShader(o),i.deleteShader(r),a}var s=(r(u,[{key:"setUniforms",value:function(t){var e=this;this.uniforms=[],this.textures={};var n=0;t.forEach(function(t){e.uniforms.push(t),t.init(e,n)&&n++,t.afterInit()})}},{key:"updateProgram",value:function(t){var e,n=this.gl,i=function(t){var e,n=0;if(0===t.length)return n;for(e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}(t);this.cache[i]?(e=this.cache[i],n.useProgram(e)):(e=a(n,"attribute vec4 aVertexPosition;\nvoid main() {\n  gl_Position = aVertexPosition;\n}",t),this.cache[i]=e),this.programInfo={program:e,attribLocations:{vertexPosition:n.getAttribLocation(e,"aVertexPosition")}},this.uniforms.forEach(function(t){t.alloc(e)})}},{key:"setCurrentTime",value:function(){this.lastRenderDate=.001*window.performance.now()}},{key:"reset",value:function(){this.lastRenderDate=0,this.ellapsedTime=0,this.uniforms.forEach(function(t){try{t.reset()}catch(t){}})}},{key:"setFragmentShader",value:function(t){this.programInfo&&this.autopurge&&this.gl.deleteProgram(this.programInfo.program),this.ellapsedTime=0,this.lastRenderDate=0;var e=-1<t.indexOf("void mainImage"),n="precision mediump float;";this.uniforms.forEach(function(t){n+="\n".concat(t.declaration)}),n+="\n".concat(t),e&&(n=(n+="\nvoid main() {\n        mainImage(gl_FragColor, gl_FragCoord.xy);\n      }").replace(/texture\(/g,"texture2D(")),this.updateProgram(n)}},{key:"setSize",value:function(t,e){this.canvas.width=t,this.canvas.height=e,this.gl.viewport(0,0,t,e),this.uniforms.forEach(function(t){t.update()})}},{key:"updateUniforms",value:function(){var e=this,t=.001*window.performance.now(),n=t-this.lastRenderDate;this.lastRenderDate=t,this.ellapsedTime+=n,this.uniforms.forEach(function(t){t.update(e.ellapsedTime)})}},{key:"clear",value:function(){var t=this.gl;t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}},{key:"draw",value:function(t){var e=0<arguments.length&&void 0!==t&&t;if(this.clear(),this.programInfo){var n=this.gl,i=n.FLOAT;n.bindBuffer(n.ARRAY_BUFFER,this.quadBuffer),n.vertexAttribPointer(this.programInfo.attribLocations.vertexPosition,2,i,!1,0,0),n.enableVertexAttribArray(this.programInfo.attribLocations.vertexPosition),n.useProgram(this.programInfo.program),e&&(this.lastRenderDate=.001*window.performance.now()),this.updateUniforms(),n.drawArrays(n.TRIANGLE_STRIP,0,4)}}},{key:"destroy",value:function(){var e=this;Object.keys(this.cache).forEach(function(t){e.gl.deleteProgram(e.cache[t])}),this.uniforms.forEach(function(t){t.destroy()}),this.canvas.width=1,this.gl.canvas.height=1,this.gl.getExtension("WEBGL_lose_context").loseContext()}}]),u);function u(t){i(this,u);var e=t.getContext("webgl2");if(!(e=(e=(e=e||t.getContext("experimental-webgl2"))||t.getContext("webgl"))||t.getContext("experimental-webgl")))throw new Error("No WebGL");this.gl=e,this.canvas=t,this.programInfo=null,this.cache={},this.quadBuffer=function(t){var e=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),e}(e),this.autopurge=!1,this.lastRenderDate=0,this.ellapsedTime=0,this.uniforms=[],this.textures=[]}function c(t,e,n,i,o,r,a,s,u,c){"boolean"!=typeof a&&(u=s,s=a,a=!1);var d,f="function"==typeof n?n.options:n;if(t&&t.render&&(f.render=t.render,f.staticRenderFns=t.staticRenderFns,f._compiled=!0,o&&(f.functional=!0)),i&&(f._scopeId=i),r?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,u(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},f._ssrRegister=d):e&&(d=a?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),d)if(f.functional){var h=f.render;f.render=function(t,e){return d.call(e),h(t,e)}}else{var l=f.beforeCreate;f.beforeCreate=l?[].concat(l,d):[d]}return n}var d=c({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.webglAvailable?n("canvas",{ref:"canvas",staticClass:"vue-shader",style:"background-color:"+t.bgColor},[t._t("default"),t._v(" "),t.injectShaderToyUniforms?n("gl-fx-time",{attrs:{name:"iTime"}}):t._e(),t._v(" "),t.injectShaderToyUniforms?n("gl-fx-time",{attrs:{"is-delta":!0,name:"iTimeDelta"}}):t._e(),t._v(" "),t.injectShaderToyUniforms?n("gl-fx-frame",{attrs:{name:"iFrame"}}):t._e(),t._v(" "),t.injectShaderToyUniforms?n("gl-fx-resolution",{attrs:{name:"iResolution"}}):t._e(),t._v(" "),t.injectShaderToyUniforms?n("gl-fx-mouse",{attrs:{name:"iMouse"}}):t._e()],2):n("p",[t._v("WebGL not available on this device")])},staticRenderFns:[]},void 0,{name:"GlFx",props:{isShaderToy:{type:[Boolean],default:!0},injectShaderToyUniforms:{type:[Boolean],default:!0},code:{type:String,default:null},autoplay:{type:Boolean,default:!0},bgColor:{type:String,default:"black"}},data:function(){return{webglAvailable:!0,uniforms:[]}},watch:{code:function(t){this.context.setFragmentShader(t),this.draw()},autoplay:function(t){t&&(this.context.setCurrentTime(),this.draw())}},created:function(){this.destroyed=!1},mounted:function(){try{var e=this,t=e.$refs.canvas;try{e.context=new s(t)}catch(t){return console.error(t),e.$emit("noWebGL"),void(e.webglAvailable=!1)}return e.uniforms.forEach(function(t){t.$on("ready",e.onUniformReady)}),e.onUniformReady(),function(t,e,n){return n?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}()}catch(e){return Promise.reject(e)}},beforeDestroy:function(){this.destroyed=!0,window.removeEventListener("resize",this.resize),cancelAnimationFrame(this.rafId),this.context.destroy()},methods:{resize:function(){var t=this.$refs.canvas;this.context.setSize(t.offsetWidth,t.offsetHeight)},onUniformReady:function(){var e=!0;this.uniforms.forEach(function(t){e&=t.ready}),e&&this.start()},start:function(){try{this.context.setUniforms(this.uniforms),this.context.setFragmentShader(this.code),window.addEventListener("resize",this.resize),this.resize(),this.draw(),this.$emit("started")}catch(t){console.error(t)}},draw:function(){this.destroyed||(this.context.draw(),this.autoplay&&(this.rafId=requestAnimationFrame(this.draw)))},registerUniform:function(t){this.uniforms.push(t)}}},void 0,!1,void 0,!1,void 0,void 0,void 0),f={props:{name:{type:String,default:""},input:{type:String,default:null}},data:function(){return{error:!1,ready:!1}},computed:{value:function(){return this.input}},render:function(){return""},methods:{init:function(){return!1},alloc:function(t,e){return t.getUniformLocation(e.program,this.name)},update:function(){},destroy:function(){}}};var h=c({},void 0,{name:"GlFxTypeSampler2D",mixins:[f],props:{input:{type:String,default:null},vflip:{type:Boolean,default:!1},mipmap:{type:Boolean,default:!1}},data:function(){return{img:null,forceUpdate:!1}},computed:{value:function(){return this.img}},watch:{vflip:function(){this.forceUpdate=!0}},mounted:function(){try{var e=this;return function(t,e){return t&&t.then?t.then(e):e(t)}(function(t,e){try{var n=t()}catch(t){return e(t)}return n&&n.then?n.then(void 0,e):n}(function(){return function(t,e,n){return n?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}(e.loadPic(e.input),function(t){e.img=t})},function(){e.error=!0,e.$emit("error")}),function(){e.ready=!0,e.$emit("ready")})}catch(e){return Promise.reject(e)}},methods:{loadPic:function(i){return new Promise(function(t,e){var n=new Image;n.crossOrigin="undefined",n.onload=function(){return t(n)},n.onerror=e,n.src=i})},init:function(t){return this.initTexture(t)},update:function(t,e){t.uniform1i(e.loc,e.index),t.activeTexture(t["TEXTURE".concat(e.index)]),t.bindTexture(t.TEXTURE_2D,e.texture),this.forceUpdate&&(t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.vflip),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.value),this.forceUpdate=!1)},initTexture:function(t){function e(t){return 0==(t&t-1)}var n=this.value,i=this.mipmap,o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.vflip),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),i&&e(n.width)&&e(n.height)?t.generateMipmap(t.TEXTURE_2D):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR)),o},destroy:function(t,e){t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(e.texture)}}},"data-v-d19b1b76",void 0,void 0,!1,void 0,void 0,void 0),l=c({},void 0,{name:"GlFxTypeFloat",mixins:[f],props:{input:{type:Number,default:null}},mounted:function(){this.ready=!0,this.$emit("ready")},methods:{update:function(t,e){t.uniform1f(e.loc,this.value)}}},"data-v-984e55ba",void 0,void 0,!1,void 0,void 0,void 0),m=c({},void 0,{name:"GlFxTypeInt",mixins:[f],props:{input:{type:Number,default:null}},mounted:function(){this.ready=!0,this.$emit("ready")},methods:{update:function(t,e){t.uniform1i(e.loc,Math.floor(this.value))}}},"data-v-57c74d3b",void 0,void 0,!1,void 0,void 0,void 0),p={components:{UniformSampler2D:h,Uniformfloat:l,Uniformvec3:c({},void 0,{name:"GlFxTypeVec3",mixins:[f],props:{input:{type:Array,default:null}},mounted:function(){this.ready=!0,this.$emit("ready")},methods:{update:function(t,e){t.uniform3fv(e.loc,this.value)}}},"data-v-24198ea8",void 0,void 0,!1,void 0,void 0,void 0),Uniformvec2:c({},void 0,{name:"GlFxTypeVec2",mixins:[f],props:{input:{type:Array,default:null}},mounted:function(){this.ready=!0,this.$emit("ready")},methods:{update:function(t,e){t.uniform2fv(e.loc,this.value)}}},"data-v-6513cfae",void 0,void 0,!1,void 0,void 0,void 0),Uniformvec4:c({},void 0,{name:"GlFxTypeVec4",mixins:[f],props:{input:{type:Array,default:null}},mounted:function(){this.ready=!0,this.$emit("ready")},methods:{update:function(t,e){t.uniform4fv(e.loc,this.value)}}},"data-v-601d30b1",void 0,void 0,!1,void 0,void 0,void 0),Uniformint:m},props:{type:{type:String,default:null},name:{type:String,default:""},input:{type:[String,Array,Number,Boolean,Object,Date,Symbol],default:null}},data:function(){return{ready:!1,context:null,glInfo:{program:null,loc:null,index:null,texture:null}}},computed:{declaration:function(){return"uniform ".concat(this.getType(),"   ").concat(this.name,";")},value:function(){return this.$refs.child.value}},created:function(){this.$parent.registerUniform&&this.$parent.registerUniform(this)},methods:{onReady:function(){this.ready=!0,this.$emit("ready")},getType:function(){return this.type},getTypeComponent:function(){switch(this.type.toLowerCase()){case"sampler2d":return"UniformSampler2D";default:return"Uniform".concat(this.getType())}},init:function(t,e){var n=1<arguments.length&&void 0!==e?e:0;return this.context=t,this.glInfo.index=n,this.glInfo.texture=this.$refs.child.init(this.context.gl,this.glInfo),this.glInfo.texture},afterInit:function(){},alloc:function(t){this.glInfo.program=t,this.glInfo.loc=this.context.gl.getUniformLocation(this.glInfo.program,this.name)},beforeUpdate:function(){},update:function(t){this.beforeUpdate(t),this.$refs.child.update(this.context.gl,this.glInfo),this.afterUpdate(t)},afterUpdate:function(){},destroy:function(){this.$refs.child.destroy(this.context.gl,this.glInfo),this.context=null}}},v=c({render:function(){var t=this.$createElement;return(this._self._c||t)(this.getTypeComponent(),this._b({ref:"child",tag:"component",attrs:{name:this.name,input:this.input},on:{ready:this.onReady}},"component",this.$attrs,!1))},staticRenderFns:[]},void 0,{mixins:[p],props:{type:{type:String,required:!0}},methods:{}},"data-v-7bb9a568",!1,void 0,!1,void 0,void 0,void 0),g=c({render:function(){var t=this.$createElement;return(this._self._c||t)(this.getTypeComponent(),this._b({ref:"child",tag:"component",attrs:{name:this.name,input:this.res},on:{ready:this.onReady}},"component",this.$attrs,!1))},staticRenderFns:[]},void 0,{mixins:[p],data:function(){return{width:0,height:0}},computed:{res:function(){return[this.width,this.height,0]}},methods:{getType:function(){return"vec3"},getTypeComponent:function(){return"Uniformvec3"},afterInit:function(){this.updateRes()},beforeUpdate:function(){this.updateRes()},updateRes:function(){this.width=this.context.gl.drawingBufferWidth,this.height=this.context.gl.drawingBufferHeight}}},"data-v-c6068436",!1,void 0,!1,void 0,void 0,void 0),y=c({render:function(){var t=this.$createElement;return(this._self._c||t)(this.getTypeComponent(),this._b({ref:"child",tag:"component",attrs:{name:this.name,input:this.time},on:{ready:this.onReady}},"component",this.$attrs,!1))},staticRenderFns:[]},void 0,{mixins:[p],props:{isDelta:{type:Boolean,default:!1}},data:function(){return{time:0,lastUpdate:0,delta:0}},computed:{value:function(){return this.isDelta?this.delta:this.time}},methods:{getType:function(){return"float"},getTypeComponent:function(){return"Uniformfloat"},afterInit:function(){this.lastUpdate=0},beforeUpdate:function(t){this.time=t,this.delta=this.time-this.lastUpdate,this.lastUpdate=this.time}}},"data-v-7f522333",!1,void 0,!1,void 0,void 0,void 0),x=c({render:function(){var t=this.$createElement;return(this._self._c||t)(this.getTypeComponent(),this._b({ref:"child",tag:"component",attrs:{name:this.name,input:this.frame},on:{ready:this.onReady}},"component",this.$attrs,!1))},staticRenderFns:[]},void 0,{mixins:[p],data:function(){return{frame:0}},computed:{value:function(){return this.frame}},methods:{getType:function(){return"int"},getTypeComponent:function(){return"Uniformint"},afterInit:function(){this.frame=0},beforeUpdate:function(){this.frame++}}},"data-v-49ceefc5",!1,void 0,!1,void 0,void 0,void 0),T=c({render:function(){var t=this.$createElement;return(this._self._c||t)(this.getTypeComponent(),this._b({ref:"child",tag:"component",attrs:{name:this.name,input:this.mouse},on:{ready:this.onReady}},"component",this.$attrs,!1))},staticRenderFns:[]},void 0,{mixins:[p],props:{mouseDrag:{type:Boolean,default:!0},reverseY:{type:Boolean,default:!0}},data:function(){return{contextWidth:0,contextHeight:0,canvas:null,mouseDown:!1,mouseX:0,mouseY:0}},computed:{mouse:function(){return[this.x,this.y,this.z,this.w]},x:function(){return this.mouseX},y:function(){return this.mouseY},z:function(){return this.mouseDown?1:0},w:function(){return this.mouseDown?1:0}},methods:{getType:function(){return"vec4"},getTypeComponent:function(){return"Uniformvec4"},afterInit:function(){this.canvas=this.context.canvas,this.canvas.addEventListener("mousedown",this.onMouseDown),this.mouseDrag?this.canvas.addEventListener("mousedown",this.onMouseStartDrag):this.canvas.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.updateRes()},beforeUpdate:function(){this.updateRes()},updateRes:function(){this.contextWidth=this.context.gl.drawingBufferWidth,this.contextHeight=this.context.gl.drawingBufferHeight},onMouseMove:function(t){this.mouseX=t.offsetX,this.mouseY=this.canvas.height-t.offsetY},onMouseStartDrag:function(t){this.mouseX=t.offsetX,this.mouseY=this.canvas.height-t.offsetY,this.canvas.addEventListener("mousemove",this.onMouseMove)},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDrag&&this.canvas.removeEventListener("mousemove",this.onMouseMove),this.mouseDown=!1}}},"data-v-18d545b3",!1,void 0,!1,void 0,void 0,void 0),_=(r(E,[{key:"webGLAvailable",value:function(){return!0}}]),E);function E(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i(this,E),this.options=Object.assign({},{accessorName:"$glfx"},{},t)}_.install=function(t){t.component("gl-fx",d),t.component("gl-fx-uniform",v),t.component("gl-fx-resolution",g),t.component("gl-fx-time",y),t.component("gl-fx-frame",x),t.component("gl-fx-mouse",T)},t.exports=_}});
//# sourceMappingURL=main.1630769c.js.map